{% extends 'base.html' %}

{% block title %}{{ kindergarten.name }}{% endblock %}

{% block content %}
<!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'kindergarten_list' %}">–í—Å–µ —Å–∞–¥—ã</a></li>
        <li class="breadcrumb-item active">{{ kindergarten.name }}</li>
    </ol>
</nav>

<div class="row">
    <div class="col-md-8">
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h2 class="mb-0">{{ kindergarten.name }}</h2>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>üìç –ê–¥—Ä–µ—Å:</strong> {{ kindergarten.address }}</p>
                        <p><strong>üë• –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:</strong> {{ kindergarten.capacity }} –¥–µ—Ç–µ–π</p>
                        <p><strong>üìû –¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ kindergarten.phone }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>üìÖ –û—Å–Ω–æ–≤–∞–Ω:</strong> {{ kindergarten.established_at }}</p>
                        <p><strong>üè¢ –ì—Ä—É–ø–ø:</strong> {{ kindergarten.group_set.count }}</p>
                        <p><strong>üë©‚Äçüè´ –í–æ—Å–ø–∏—Ç–∞—Ç–µ–ª–µ–π:</strong> {{ kindergarten.kindergartenteacher_set.count }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ì—Ä—É–ø–ø—ã -->
        <div class="card mt-4">
            <div class="card-header">
                <h4 class="mb-0">üè¢ –ì—Ä—É–ø–ø—ã</h4>
            </div>
            <div class="card-body">
                {% for group in kindergarten.group_set.all %}
                <div class="border-bottom pb-3 mb-3">
                    <h5>{{ group.name }}</h5>
                    <p class="mb-1"><strong>–í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ group.age_range }}</p>
                    <p class="mb-1"><strong>–î–µ—Ç–µ–π –≤ –≥—Ä—É–ø–ø–µ:</strong> {{ group.enrollment_set.count }}</p>
                    
                    <!-- –î–µ—Ç–∏ –≤ –≥—Ä—É–ø–ø–µ -->
                    {% if group.enrollment_set.all %}
                    <div class="mt-2">
                        <strong>–î–µ—Ç–∏:</strong>
                        {% for enrollment in group.enrollment_set.all %}
                        <span class="badge bg-light text-dark">{{ enrollment.child.first_name }} {{ enrollment.child.last_name }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% empty %}
                <p class="text-muted">–ì—Ä—É–ø–ø—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <!-- –í–æ—Å–ø–∏—Ç–∞—Ç–µ–ª–∏ -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">üë©‚Äçüè´ –í–æ—Å–ø–∏—Ç–∞—Ç–µ–ª–∏</h5>
            </div>
            <div class="card-body">
                {% for kg_teacher in kindergarten.kindergartenteacher_set.all %}
                <div class="border-bottom pb-2 mb-2">
                    <strong>{{ kg_teacher.teacher.first_name }} {{ kg_teacher.teacher.last_name }}</strong>
                    <p class="mb-1 small text-muted">{{ kg_teacher.teacher.qualification }}</p>
                    <small class="text-muted">üìû {{ kg_teacher.teacher.phone_number }}</small>
                </div>
                {% empty %}
                <p class="text-muted">–í–æ—Å–ø–∏—Ç–∞—Ç–µ–ª–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</p>
                {% endfor %}
                
                <a href="{% url 'teacher_list' %}?kindergarten={{ kindergarten.pk }}" class="btn btn-outline-primary btn-sm mt-2">
                    –í—Å–µ –≤–æ—Å–ø–∏—Ç–∞—Ç–µ–ª–∏
                </a>
            </div>
        </div>

        <!-- –û—Ç–∑—ã–≤—ã -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">‚≠ê –û—Ç–∑—ã–≤—ã</h5>
            </div>
            <div class="card-body">
                {% for review in kindergarten.review_set.all|slice:":3" %}
                <div class="border-bottom pb-2 mb-2">
                    <strong>{{ review.parent_name }}</strong>
                    <div class="rating">
                        {% for i in "12345" %}
                            {% if forloop.counter <= review.rating %}‚òÖ{% else %}‚òÜ{% endif %}
                        {% endfor %}
                        ({{ review.rating }}/5)
                    </div>
                    <p class="mb-1 small">{{ review.comment|truncatewords:15 }}</p>
                    <small class="text-muted">{{ review.created_at|date:"d.m.Y" }}</small>
                </div>
                {% empty %}
                <p class="text-muted">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                {% endfor %}
                
                <a href="{% url 'review_list' %}?kindergarten={{ kindergarten.pk }}" class="btn btn-outline-primary btn-sm mt-2">
                    –í—Å–µ –æ—Ç–∑—ã–≤—ã
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
